ifdef::env-site[]
include::partial$_attributes.adoc[]
endif::[]
:page-hide-next:
:imagesdir: ../images

:ole_prerequisites: xref:./setup.adoc#prerequisites[prerequisites]

= Troubleshooting Common Errors

This page provides information for how to troubleshoot common problems and errors.

== General Advice
* Make sure you are using the latest version of *onecx-local-env*. 
* Make sure your system meets the {ole_prerequisites} for running *onecx-local-env*.
* If you encounter an error, carefully read the error message and any accompanying logs. They often provide valuable clues about the root cause of the issue.
* Check the official OneCX documentation and community forums for similar issues and solutions.
* If the problem persists, consider reaching out to OneCX support or community forums for assistance.
* When reporting an issue, provide detailed information about your environment, the steps to reproduce the problem, and any relevant logs or error messages.

== Common Pitfalls
* Insufficient System Resources: Ensure your system has enough CPU, memory, and disk space to run the OneCX Local Environment smoothly.
* Network Issues: Verify that your network connection is stable and that there are no firewall or proxy settings blocking necessary connections.
* Incorrect Configuration: Double-check your configuration files for any typos or incorrect settings.
* Outdated Software: Ensure that all required software dependencies are up-to-date.
* Are you working within WSL on Windows? Please see the {ole_prerequisites} for important notes on using WSL.

== Known Docker Issues
Docker is not perfect and sometimes issues may arise that are related to Docker itself rather than *onecx-local-env*. Here are some common Docker-related issues and their solutions:

* Docker Daemon Not Running: Ensure that the Docker daemon is running before starting the OneCX Local Environment.

* Port Conflicts: Check for any port conflicts with other applications running on your system.

=== Cleanup Docker Resources
If you encounter persistent issues, it may be helpful to clean up Docker resources used by OneCX Local Environment. +
You can remove unused Docker resources with the following commands:

[source,bash]
----
docker system prune -a
docker volume prune
docker network prune
----

[CAUTION]
====
Be cautious when using these commands, as they will remove all unused Docker resources, which may affect other Docker containers and applications on your system.
====

In case OneCX is already running, you can stop it with cleanup of volumes by executing:
[source,bash]
----
./stop-onecx.sh -c
----
This will remove all volumes used by OneCX Local Environment, which can help resolve issues related to corrupted or inconsistent data.

[CAUTION]
====
Please note that this will delete all data stored in the volumes, so use this option with caution.
====

Now you can cleanup any remaining Docker resources as described above and start OneCX again.


== Specific Issues and Solutions

=== Status Code "000" on Imports
The issue occurs when the script xref:scripts/import.adoc[`import-onecx.sh`] is executed (importing OneCX data)

.Status code 000 on Imports
image::issues/status-code-000-import-onecx.sh.png[]

.Solution icon:lightbulb-o[yellow]
* Check if the hosts files is up-to-date. See xref:setup.adoc#hosts[Setup hosts] instructions.


=== Status Code "401" on Starting
The problem occurs after logging into OneCX, although the start and import itself were successful.

.Status code 401 on Starting
image::issues/status-code-401-start-onecx.sh.png[]

.Solution icon:lightbulb-o[yellow]
* Stop the services with cleanup (remove volumes)
* Start again


=== Failed Services on Start up
The problem occurs when some services cannot be started successfully even after several attempts and timeouts.

.Message: Failed Services on Start up
image::issues/incomplete-onecx-start.png[]

.Solution icon:lightbulb-o[yellow]
* Start again


=== Missing Menu in Browser
The problem occurs sometimes after succesful starting the services

.Message: Missing Menu in Browser
image::issues/missing-menu-on-start.png[]

.Solution icon:lightbulb-o[yellow]
* Remove Browser Cache & Cookies
* Refresh browser


=== Bad gateway in Browser
The problem occurs sometimes after succesful starting the services

.Message: Bad gateway in Browser
image::issues/bad-gateway-on-mfe-start.png[]

.Solution icon:lightbulb-o[yellow]
* Start again
* Refresh browser


=== Failed to set up Networking
The problem occurs when during start up there are collisions between Docker networks. +
`Error response from daemon: failed to set up container networking`


.Message: Failed to set up container networking
image::issues/docker-deamon_failed-to-setup-container-networking.png[]

.Solution icon:lightbulb-o[yellow]
* Remove all Docker networks with
+
[source,bash]
----
docker network prune
----
+
* Start again


=== Cannot successful pull
The issue occurs if the repository is updated with `git pull` (get latest version of onecx-local-env)

.Message: Untracked local files on pulling
image::issues/untracked-files-on-pull.sh.png[]

.The directory init_data/traefik/active was created by root
image::issues/traefik-active_created-by-root.sh.png[width=400]

.Solution icon:lightbulb-o[yellow]
* Remove the active directory of Traefik manually by execution of
** `sudo rm -rf init_data/traefik/active`
* Reset the local repo (all other changes will be lost)
** `git reset --hard origin/main`
